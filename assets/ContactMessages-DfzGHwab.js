import{j as e}from"./ui-BKKtghGE.js";import{a as n}from"./vendor-DsXQwQzb.js";import{ad as w,x as C,y,z as M,A as N,J as S,Y as v,O as h,U as L,M as T,a5 as i,C as E,w as H}from"./index-BzL-sfoN.js";import{T as D,a as _,b as d,c,d as k,e as t}from"./table-DO2FNJGZ.js";import{F as A}from"./FileSaver.min-D6DqY2Qh.js";import{M as B}from"./message-square-Dz3KcmE4.js";const z=()=>{const[j,u]=n.useState([]),[p,m]=n.useState(!0),[r,x]=n.useState("");n.useEffect(()=>{(async()=>{m(!0);const{data:o}=await H.from("contact_messages").select("*").order("created_at",{ascending:!1});u(o||[]),m(!1)})()},[]);const l=j.filter(s=>s.name.toLowerCase().includes(r.toLowerCase())||s.email.toLowerCase().includes(r.toLowerCase())||s.subject.toLowerCase().includes(r.toLowerCase())||s.message.toLowerCase().includes(r.toLowerCase())),g=()=>{const o=[["Name","Email","Subject","Message","Date"],...l.map(a=>[a.name,a.email,a.subject,a.message.replace(/\n/g," "),i(new Date(a.created_at),"yyyy-MM-dd HH:mm")])].map(a=>a.map(b=>`"${String(b).replace(/"/g,'""')}"`).join(",")).join(`
`),f=new Blob([o],{type:"text/csv"});A.saveAs(f,`contact-messages-${i(new Date,"yyyy-MM-dd")}.csv`)};return p?e.jsx(w,{className:"h-64",text:"Loading messages...",ariaLabel:"Loading messages"}):e.jsx("div",{className:"space-y-6",children:e.jsxs(C,{children:[e.jsxs(y,{children:[e.jsxs(M,{className:"text-2xl font-bold text-church-burgundy flex items-center gap-2",children:[e.jsx(B,{className:"h-6 w-6"})," Contact Messages"]}),e.jsx(N,{children:"Messages sent by users from the contact page"})]}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(v,{placeholder:"Search by name, email, subject, or message...",value:r,onChange:s=>x(s.target.value)}),e.jsx(h,{onClick:()=>x(""),children:"Clear"}),e.jsx(h,{variant:"outline",onClick:g,children:"Export CSV"})]}),e.jsx("div",{className:"overflow-x-auto rounded-md border",children:e.jsxs(D,{children:[e.jsx(_,{children:e.jsxs(d,{children:[e.jsx(c,{children:"Name"}),e.jsx(c,{children:"Email"}),e.jsx(c,{children:"Subject"}),e.jsx(c,{children:"Message"}),e.jsx(c,{children:"Date"})]})}),e.jsx(k,{children:l.length===0?e.jsx(d,{children:e.jsx(t,{colSpan:5,className:"text-center py-8",children:"No messages found"})}):l.map(s=>e.jsxs(d,{children:[e.jsxs(t,{className:"font-medium flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-church-burgundy"}),s.name]}),e.jsx(t,{children:e.jsxs("a",{href:`mailto:${s.email}`,className:"text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(T,{className:"w-4 h-4"}),s.email]})}),e.jsx(t,{children:s.subject}),e.jsx(t,{className:"max-w-xs whitespace-pre-line break-words",children:s.message}),e.jsxs(t,{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(E,{className:"w-4 h-4"}),i(new Date(s.created_at),"MMM d, yyyy HH:mm")]})]},s.id))})]})})]})]})})};export{z as default};
